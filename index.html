<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fall Blacktop Camp Registration</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family:Arial, Helvetica, sans-serif;
      background:#f8f9fa; color:#2c3e50; line-height:1.6;
      min-height:100vh; padding:20px;
    }
    .container{
      max-width:800px; margin:0 auto; background:#fff; border-radius:15px;
      padding:40px; box-shadow:0 10px 30px rgba(0,0,0,.1); border:1px solid #e9ecef;
    }
    h1{font-size:2.2rem; margin-bottom:30px; text-align:center}
    .instructions{
      background:#f8f9fa; border-radius:10px; padding:25px; margin:30px 0; border:1px solid #e9ecef;
    }
    .instructions ol{padding-left:20px}
    .instructions li{margin-bottom:15px; font-size:1.1rem}
    .email-link{color:#3498db; text-decoration:none; font-weight:700}
    .email-link:hover{text-decoration:underline}
    .download-btn{
      display:inline-flex; align-items:center; gap:10px; background:#3498db; color:#fff;
      padding:20px 40px; font-size:1.2rem; font-weight:700; text-decoration:none; border-radius:10px;
      transition:all .2s ease; margin:30px 0; box-shadow:0 5px 15px rgba(52,152,219,.3);
      width:100%; justify-content:center;
    }
    .download-btn:hover{background:#2980b9; transform:translateY(-1px)}
    .divider{ text-align:center; margin:12px 0 18px; color:#6c757d; font-size:.95rem; font-style:italic}
    .pdf-container{ margin:16px 0 30px; border:1px solid #e9ecef; border-radius:10px; overflow:hidden; box-shadow:0 2px 10px rgba(0,0,0,.05)}
    .pdf-iframe{ width:100%; height:80vh; border:0; display:block }
    .pdf-viewer{ width:100%; height:80vh; border:0; display:block }
    .footer{ margin-top:20px; padding-top:20px; border-top:1px solid #e9ecef; font-size:.95rem; color:#6c757d; text-align:center}
    .download-icon{font-size:1.4rem}
    .pdf-toolbar{ background:#f8f9fa; padding:10px; border-bottom:1px solid #e9ecef; display:flex; gap:10px; align-items:center; flex-wrap:wrap }
    .pdf-toolbar button{ padding:8px 12px; border:1px solid #ddd; background:#fff; border-radius:4px; cursor:pointer; font-size:14px }
    .pdf-toolbar button:hover{ background:#f8f9fa }
    .pdf-toolbar .download-btn-small{ background:#3498db; color:#fff; border-color:#3498db }
    .pdf-toolbar .download-btn-small:hover{ background:#2980b9 }
    @media (max-width:600px){
      .container{padding:25px}
      h1{font-size:1.8rem}
      .download-btn{padding:16px 24px; font-size:1.05rem}
      .pdf-iframe{height:70vh}
      .pdf-viewer{height:70vh}
      .pdf-toolbar{ padding:8px; gap:5px }
      .pdf-toolbar button{ padding:6px 8px; font-size:12px }
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script>
    // Initialize PDF.js
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    
    let pdfDoc = null;
    let pageNum = 1;
    let pageRendering = false;
    let pageNumPending = null;
    let scale = 1.5;
    let canvas = null;
    let ctx = null;
    
    function renderPage(num) {
      pageRendering = true;
      pdfDoc.getPage(num).then(function(page) {
        const viewport = page.getViewport({scale: scale});
        canvas.height = viewport.height;
        canvas.width = viewport.width;
        
        const renderContext = {
          canvasContext: ctx,
          viewport: viewport
        };
        
        const renderTask = page.render(renderContext);
        renderTask.promise.then(function() {
          pageRendering = false;
          if (pageNumPending !== null) {
            renderPage(pageNumPending);
            pageNumPending = null;
          }
        });
      });
    }
    
    function queueRenderPage(num) {
      if (pageRendering) {
        pageNumPending = num;
      } else {
        renderPage(num);
      }
    }
    
    function onPrevPage() {
      if (pageNum <= 1) return;
      pageNum--;
      queueRenderPage(pageNum);
    }
    
    function onNextPage() {
      if (pageNum >= pdfDoc.numPages) return;
      pageNum++;
      queueRenderPage(pageNum);
    }
    
    function onZoomIn() {
      scale += 0.25;
      renderPage(pageNum);
    }
    
    function onZoomOut() {
      if (scale <= 0.5) return;
      scale -= 0.25;
      renderPage(pageNum);
    }
    
    function onDownload() {
      // Create a link to download the original PDF
      const link = document.createElement('a');
      link.href = '/blacktop-camp-registration-2023.pdf';
      link.download = 'blacktop-camp-registration-2023.pdf';
      link.click();
    }
    
    // Load PDF when page loads
    window.addEventListener('load', function() {
      canvas = document.getElementById('pdf-canvas');
      ctx = canvas.getContext('2d');
      
      // Load the PDF
      const loadingTask = pdfjsLib.getDocument('/blacktop-camp-registration-2023.pdf');
      loadingTask.promise.then(function(pdfDoc_) {
        pdfDoc = pdfDoc_;
        document.getElementById('page-count').textContent = pdfDoc.numPages;
        renderPage(pageNum);
      }).catch(function(error) {
        console.error('Error loading PDF:', error);
        // Fallback to iframe if PDF.js fails
        document.querySelector('.pdf-viewer-container').style.display = 'none';
        document.querySelector('.pdf-iframe').style.display = 'block';
      });
    });
  </script>
</head>
<body>
  <div class="container">
    <h1>üèÄ Fall Blacktop Camp Registration</h1>

    <main role="main" aria-labelledby="title">
      <div class="instructions" aria-label="Instructions">
        <ol>
          <li><strong>Download</strong> the registration form below.</li>
          <li><strong>Fill it out</strong> on your device <em>or in the viewer on this page</em>.</li>
          <li><strong>Save and email</strong> to:
            <a class="email-link" href="mailto:robertjanice@bellsouth.net">robertjanice@bellsouth.net</a>
          </li>
        </ol>
      </div>

      <!-- Primary, foolproof path -->
      <a class="download-btn" href="/blacktop-camp-registration-2023.pdf" download aria-label="Download the registration form">
        <span class="download-icon">‚¨áÔ∏è</span>
        Download &amp; Fill the Registration Form
      </a>

      <!-- Secondary inline option -->
      <div class="divider">
        <strong>Or fill it out right here!</strong> The form below works on all devices - phones, tablets, and computers.
      </div>

      <div class="pdf-container" aria-label="Embedded registration form">
        <!-- PDF.js Viewer -->
        <div class="pdf-viewer-container">
          <div class="pdf-toolbar">
            <button onclick="onPrevPage()">‚Üê Previous</button>
            <button onclick="onNextPage()">Next ‚Üí</button>
            <span>Page <span id="page-num">1</span> of <span id="page-count">1</span></span>
            <button onclick="onZoomOut()">Zoom Out</button>
            <button onclick="onZoomIn()">Zoom In</button>
            <button class="download-btn-small" onclick="onDownload()">‚¨áÔ∏è Download</button>
          </div>
          <canvas id="pdf-canvas" class="pdf-viewer"></canvas>
        </div>
        
        <!-- Fallback iframe (hidden by default) -->
        <iframe
          class="pdf-iframe"
          title="Registration Form"
          src="/blacktop-camp-registration-2023.pdf#toolbar=1&navpanes=0&statusbar=0&view=FitH"
          allow="fullscreen; clipboard-read; clipboard-write"
          type="application/pdf"
          style="display:none;">
          <p>Your browser doesn't support inline PDFs. <a href="/blacktop-camp-registration-2023.pdf">Download the registration form</a> instead.</p>
        </iframe>
      </div>
    </main>

    <div class="footer">
      <strong>Instructions:</strong> Fill out the form above, then use the "Download" button in the toolbar to save your completed form.<br/>
      Email your completed form to: <a class="email-link" href="mailto:robertjanice@bellsouth.net">robertjanice@bellsouth.net</a><br/>
      Questions? Email us at the same address.
    </div>
  </div>
</body>
</html>